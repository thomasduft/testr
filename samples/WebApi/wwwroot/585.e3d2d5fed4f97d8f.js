"use strict";(self.webpackChunkwebclient=self.webpackChunkwebclient||[]).push([[585],{9585:(U,v,n)=>{n.r(v),n.d(v,{IssueModule:()=>_});var h=n(6895),c=n(5699),A=n(9116),C=n(5202),u=n(337),M=n(709),e=n(5062),w=n(7165);class r{constructor(s){this._http=s}assignees(){return this._http.get("issue/assignees")}myWork(){return this._http.get("issue/mywork")}create(){return this._http.post("issue/new",null)}save(s){return this._http.post("issue",s)}get(s){return this._http.get(`issue/${s}`)}process(s){return this._http.post("issue/process",s)}static#e=this.\u0275fac=function(t){return new(t||r)(e.LFG(w.O))};static#t=this.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac})}var I=n(655),T=n(5570),E=n(5370),f=n(453);const y=function(l){return["detail",l]};function b(l,s){if(1&l&&(e.TgZ(0,"div",11)(1,"div",12)(2,"p")(3,"b"),e.SDv(4,13),e.qZA(),e.TgZ(5,"span"),e._uU(6),e.qZA()(),e.TgZ(7,"div",14)(8,"p")(9,"b"),e.SDv(10,15),e.qZA(),e.TgZ(11,"span"),e._uU(12),e.qZA()(),e.TgZ(13,"p")(14,"b"),e.SDv(15,16),e.qZA(),e.TgZ(16,"span"),e._uU(17),e.qZA()()()()()),2&l){const t=s.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(4,y,null==t?null:t.id)),e.xp6(5),e.hij(" ",null==t?null:t.title,""),e.xp6(6),e.hij(" ",null==t?null:t.state,""),e.xp6(5),e.hij(" ",null==t?null:t.assignee,"")}}const N=function(){return["detail/new"]};let p=class m{constructor(s,t){this._router=s,this._service=t,this.workspace="pane"}ngOnInit(){this.myWork$=this._service.myWork()}create(){this._router.navigate(["./detail/new"])}reload(){this.ngOnInit()}static#e=this.\u0275fac=function(t){return new(t||m)(e.Y36(c.F0),e.Y36(r))};static#t=this.\u0275cmp=e.Xpm({type:m,selectors:[["tw-issue-dashboard"]],hostVars:2,hostBindings:function(t,i){2&t&&e.Tol(i.workspace)},features:[e._Bn([r])],decls:15,vars:5,consts:function(){let s,t,i,o;return s=$localize`:␟66db799d67958d4b0765181d072df62e2d1c16f5␟1176990449799757498:Issues`,t=$localize`:␟8737210008395d7b014e5118d2ed198ae9745215␟2517309683610083249:Title:`,i=$localize`:␟caeaea23981b9730ff04e00174619919105e94a5␟416077535002182849:State:`,o=$localize`:␟cb1b286d9e2e10db8f3ee4d22b535943b61b0a02␟3997253702608180743:Assignee:`,[[1,"pane__left"],[3,"rows"],["list",""],s,[1,"button__bar"],[1,"button",3,"routerLink"],["name","plus"],["type","button",3,"click"],["name","refresh"],["twTemplate","issue-item"],[1,"pane__main"],[1,"list__item"],["routerLinkActive","active",3,"routerLink"],t,[1,"list__itemDetail"],i,o]},template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"tw-list",1,2),e.ALo(3,"async"),e.TgZ(4,"tw-header")(5,"h3"),e.SDv(6,3),e.qZA(),e.TgZ(7,"div",4)(8,"a",5),e._UZ(9,"tw-icon",6),e.qZA(),e.TgZ(10,"button",7),e.NdJ("click",function(){return i.reload()}),e._UZ(11,"tw-icon",8),e.qZA()()(),e.YNc(12,b,18,6,"ng-template",9),e.qZA()(),e.TgZ(13,"div",10),e._UZ(14,"router-outlet"),e.qZA()),2&t&&(e.xp6(1),e.Q6J("rows",e.lcZ(3,2,i.myWork$)),e.xp6(7),e.Q6J("routerLink",e.DdM(4,N)))},dependencies:[c.lC,c.rH,c.Od,E.o,f.ns,f.Gt,f.VC,h.Ov],encapsulation:2})};p=(0,I.gn)([T.k],p);class g{constructor(s){this.key=g.KEY,this.type=u.AF,this.title="",s.map(i=>({key:i,value:i})),this.editors=[{key:"id",type:u.md,label:"Id",required:!1},{key:"title",type:u.P8,label:"Message",required:!0,minLength:3,maxLength:140},{key:"description",type:u.N5,label:"Description",required:!1,maxLength:500}]}static#e=this.KEY="issuedetailslot"}var D=n(8613),O=n(5108),Z=n(1803);const $=["formDef"];function R(l,s){if(1&l){const t=e.EpF();e.TgZ(0,"tw-trigger-info",3),e.NdJ("trigger",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.triggerClicked(o))}),e.qZA()}if(2&l){const t=e.oxw(),i=e.MAs(4);e.Q6J("canTrigger",i.formIsValid)("triggerInfo",t.triggerInfo)}}let d=class S{constructor(s,t,i,o,a){this._route=s,this._router=t,this._user=i,this._service=o,this._slotRegistry=a,this.key=g.KEY,this.canTrigger=!1,this.isNew=!1}ngOnInit(){this._routeParams$=this._route.params.subscribe(s=>{s.id&&this.init(s.id)})}submitted(s){this._issue$=this._service.save(s).subscribe(t=>{t>0&&this.back()})}cancel(){this.back()}triggerClicked(s){this._issue$=this._service.process({id:this.viewModel.id,trigger:s,assignee:this.viewModel.assignee,title:this.viewModel.title,description:this.viewModel.description}).subscribe(i=>{i.triggerInfo.succeeded&&i.viewModel.assignee!==this._user.userName?this._router.navigate(["dispatch",i.viewModel.assignee,"issue"]):(this.viewModel=i.entity,this.triggerInfo=i.triggerInfo,this.entity=i.entity)})}back(){this._router.navigate(["issue"])}init(s){this._assignees$=this._service.assignees().subscribe(t=>{this._slotRegistry.register(new g(t)),"new"!==s?this.load(s.toString()):this.create()})}load(s){this._issue$=this._service.get(s).subscribe(t=>{this.key=g.KEY,this.viewModel=t.viewModel,this.triggerInfo=t.triggerInfo,this.entity=t.entity})}create(){this._issue$=this._service.create().subscribe(s=>{this.viewModel=s.viewModel,this.triggerInfo=s.triggerInfo,this.entity=s.entity,this.isNew=!0})}static#e=this.\u0275fac=function(t){return new(t||S)(e.Y36(c.gz),e.Y36(c.F0),e.Y36(D.K),e.Y36(r),e.Y36(u.FR))};static#t=this.\u0275cmp=e.Xpm({type:S,selectors:[["tw-issue"]],viewQuery:function(t,i){if(1&t&&e.Gf($,5),2&t){let o;e.iGM(o=e.CRH())&&(i.formDef=o.first)}},features:[e._Bn([r])],decls:5,vars:5,consts:[[3,"canTrigger","triggerInfo","trigger",4,"ngIf"],[3,"showSave","showCancel","key","viewModel","submitted","resetted"],["formDef",""],[3,"canTrigger","triggerInfo","trigger"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,R,1,2,"tw-trigger-info",0),e.qZA(),e.TgZ(2,"div")(3,"tw-formdef",1,2),e.NdJ("submitted",function(a){return i.submitted(a)})("resetted",function(){return i.cancel()}),e.qZA()()),2&t){const o=e.MAs(4);e.xp6(1),e.Q6J("ngIf",!i.isNew&&o),e.xp6(2),e.Q6J("showSave",i.isNew)("showCancel",i.isNew)("key",i.key)("viewModel",i.viewModel)}},dependencies:[h.O5,O.w,Z.S],encapsulation:2})};d=(0,I.gn)([T.k],d);const P=[{path:"",component:p,children:[{path:"detail/:id",component:d},{path:"detail/new",component:d}]}];class _{static#e=this.\u0275fac=function(t){return new(t||_)};static#t=this.\u0275mod=e.oAB({type:_});static#s=this.\u0275inj=e.cJS({providers:[r],imports:[h.ez,c.Bz.forChild(P),u.eO,M.L,A.Q,C.p,c.Bz]})}}}]);